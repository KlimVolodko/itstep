<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
        <div id="app"></div>
        
        <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
        <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
        <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
        <script type="text/babel">
            
        function App(){
            
            const [book, setBook] = React.useState(
                {
                    title: "",
                    text: "",
                    picture: "",
                    date: ""
                }
            );
            
            const [books, setBooks] = React.useState([
                {
                    title: "блог",
                    text: "орплпрл рп",
                    picture: "",
                    date: ""
                }
            ]);

            const [editIndex, setEditIndex] = React.useState(-1);

            function handleFormSubmit(event){
                event.preventDefault();
                if(editIndex == - 1){
                    setBooks([...books, book]);
                    setBook({
                        title: "",
                        author: "",
                        genre: "",
                        pages: 0
                    });
                } else {
                    books[editIndex] = book;
                    setBooks([...books]);
                    setBook({
                        title: "",
                        author: "",
                        genre: "",
                        pages: 0
                    });
                    setEditIndex(-1);
                }
            }

            function handleTitleChange(event){
                setBook({...book, title: event.target.value});
            }
            function handleTextChange(event){
                setBook({ ...book, text: event.target.value });
            }
            function handlePictureChange(event) {
                setBook({ ...book, piture: event.target.value });
            }
            function handleDateChange(event) {
                setBook({ ...book, date: event.target.value });
            }
            
            function handleBookDelete(event){
                let index = +event.target.dataset.id;
                books.splice(index, 1);
                setBooks([...books]);
            }

            function handleBookEdit(event){
                let index = +event.target.dataset.id; // event.target - кнопка dataset.id - атрибут data-id кнопки
                // index - номер книги в массиве books
                let editBook = books[index]; // редактируемая книга, поулченная по номеру элемента в массиве
                setBook({
                    title: editBook.title,
                    author: editBook.author,
                    genre: editBook.genre,
                    pages: editBook.pages
                });
                setEditIndex(index);
            }

            return <>(
                <div>
                    <form action="" onSubmit={handleFormSubmit}>
                        <div>
                            <label for="title">Название</label>
                            <input type="text" value={book.title} name="title" id="title" onChange={handleTitleChange}/>
                        </div>
                        <div>
                            <label for="text">Текст</label>
                            <textarea name="text" id="text" value={book.text} onChange={handleTextChange} />
                        </div>
                        <div>
                            <img src={require('path/to/img.png').default} />
                            <input type="text" value={book.picture} name="picture" id="picture" onChange={handlePictureChange}/>
                        </div>
                        <div>
                            <label for="date">Дата</label>
                            <input type="text" name="pages" id="pages" value={book.pages} onChange={handleDateChange} />
                        </div>
                        <div>
                            <button type="submit">{editIndex > -1 ? <>Сохранить</> : <>Добавить</>}</button>    
                        </div>    
                    </form>
                </div>
                <div>
                                            {
                            books.map(function(item, index){
                                return  <div>
                                            <div>{index+1}</div>
                                            <div>{item.title}</div>
                                            <div>{item.text}</div>
                                            <div>{item.picture}</div>
                                            <div>{item.date}</div>
                                            <div>
                                                <button onClick={handleBookEdit} data-id={index}>Редактировать</button>
                                                <button onClick={handleBookDelete} data-id={index}>Удалить</button>
                                            </div>
                                        </div>
                            })
                        }
                    
                </div> )
            </>;

        }
        ReactDOM.createRoot(
            document.getElementById("app")
        )
        .render(
            <App />
        )
        </script>
    </body>
</html>